<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>HoneySweetpot ‚Äì Local Classifieds</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="app.js"></script>
</head>
<body>
    <header>
        <div class="logo">Honey<span>Sweetpot</span> <img src="/categories/HoneyPot.webp" alt="HoneySweetpot Logo" style="height: 60px; vertical-align: bottom; margin-left: 5px;"></div>
        <div class="header-actions">
            <button class="btn" id="loginBtn">Login</button>
            <button class="btn" id="signupBtn">Sign up</button>
            <a href="post-ad.html" class="btn primary" id="postAdBtn" style="text-decoration:none;">+ Post Ad</a>
        </div>
    </header>
    <main>
        <section class="search-section">
            <div class="search-row">
                <input id="searchText" type="text" placeholder="Find cars, phones, property..." />
                <select id="provinceSelect">
                    <option value="All provinces">All provinces</option>
                    <option value="Gauteng">Gauteng</option>
                    <option value="Western Cape">Western Cape</option>
                    <option value="KwaZulu-Natal">KwaZulu-Natal</option>
                    <option value="Eastern Cape">Eastern Cape</option>
                    <option value="Free State">Free State</option>
                    <option value="North West">North West</option>
                    <option value="Limpopo">Limpopo</option>
                    <option value="Mpumalanga">Mpumalanga</option>
                    <option value="Northern Cape">Northern Cape</option>
                </select>
                <select id="searchLocation">
                    <option value="">Select Town / City</option>
                </select>
                <button id="searchBtn">Search</button>
            </div>
        </section>
        <h2 class="section-title">Browse by category</h2>
        <section class="categories" id="categoryList">
            <div class="category-card" data-category="Cars"><img src="/categories/cars.webp" alt="Cars" class="category-icon-img"><span><b>Cars</b></span></div>
            <div class="category-card" data-category="Phones"><img src="/categories/phones.webp" alt="Phones" class="category-icon-img"><span><b>Phones & Tablets</b></span></div>
            <div class="category-card" data-category="Property"><img src="/categories/property.webp" alt="Property" class="category-icon-img"><span><b>Property</b></span></div>
            <div class="category-card" data-category="Electronics"><img src="/categories/electronics.webp" alt="Electronics" class="category-icon-img"><span><b>Electronics</b></span></div>
            <div class="category-card" data-category="Fashion & Beauty"><img src="/categories/fashion.webp" alt="Fashion" class="category-icon-img"><span><b>Fashion & Beauty</b></span></div>
            <div class="category-card" data-category="Clothing"><img src="/categories/clothing.webp" alt="Clothing" class="category-icon-img"><span><b>Clothing</b></span></div>
            <div class="category-card" data-category="Jobs"><img src="/categories/jobs.webp" alt="Jobs" class="category-icon-img"><span><b>Jobs</b></span></div>
            <div class="category-card" data-category="Green Energy"><img src="/categories/Green Energy.webp" alt="Green Energy" class="category-icon-img"><span><b>Green Energy</b></span></div>
            <div class="category-card" data-category="Other"><img src="/categories/other.webp" alt="Other" class="category-icon-img"><span><b>Other</b></span></div>
        </section>
        <h2 class="section-title">Filter</h2>
        <div class="filters-container">
            <div class="filters-row">
                <select id="filterCategory">
                    <option value="">Category: All</option>
                    <option value="Cars">Cars</option>
                    <option value="Phones">Phones & Tablets</option>
                    <option value="Property">Property</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Fashion & Beauty">Fashion & Beauty</option>
                    <option value="Clothing">Clothing</option>
                    <option value="Jobs">Jobs</option>
                    <option value="Green Energy">Green Energy</option>
                    <option value="Other">Other</option>
                </select>
                <select id="filterSort">
                    <option value="newest">Sort: Newest</option>
                    <option value="priceLow">Price: Low to High</option>
                    <option value="priceHigh">Price: High to Low</option>
                </select>
                <select id="filterCondition">
                    <option value="">Condition: All</option>
                    <option value="New">New</option>
                    <option value="Used">Used</option>
                    <option value="Needs Repair">Needs Repair</option>
                </multi-select>
            </div>
            <div class="filters-row">
                <div class="price-range">
                    <span>Price:</span>
                    <input type="number" id="priceMin" placeholder="Min" min="0">
                    <span>-</span>
                    <input type="number" id="priceMax" placeholder="Max" min="0">
                </div>
                <label class="verified-toggle">
                    <input type="checkbox" id="filterVerified">
                    <span>Verified Only</span>
                </label>
            </div>
        </div>
        <div style="text-align: left; margin-bottom: 16px;">
            <a href="#" id="moreFiltersBtn" style="color: #00008B; text-decoration: underline; font-weight: 600; font-size: 0.9rem;">More Filters</a>
        </div>

        <!-- ADDITIONAL FILTERS SECTION (dynamic by category) -->
        <div id="dynamicFiltersContainer" style="display: none; background: #f9f9f9; padding: 15px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 20px;">
            <h4 style="margin-top: 0; margin-bottom: 10px; font-size: 1rem;">Additional Filters</h4>

           <!-- This is where the correct category filters will appear -->
<div id="dynamicCategoryFilters" style="display:flex; flex-direction:column; gap:10px;"></div>

<!-- Bottom-left Apply Filters link -->
<div style="margin-top: 12px; text-align: left;">
    <a href="#" id="applyDynamicFiltersLink"
       style="color: #00008B; text-decoration: underline; font-weight: 600; font-size: 0.85rem;">
        Apply Filters
    </a>
</div>

            <!-- ===== CATEGORY FILTER TEMPLATES ===== -->

            <!-- CARS -->
            <template id="carFilters">
              <div class="filters-row car-filters">
                <label>Make:</label>
                <select>
                  <option>All</option>
                  <option>Toyota</option>
                  <option>VW</option>
                  <option>BMW</option>
                  <!-- add more makes -->
                </select>

                <label>Model:</label>
                <select>
                  <option>All</option>
                  <option>Golf 6</option>
                  <option>Corolla Quest</option>
                  <!-- add more models -->
                </select>

                <label>Year:</label>
                <select>
                  <option>All</option>
                  <!-- you can generate 1990‚Äì2025 with JS later -->
                  <option>2025</option>
                  <option>2024</option>
                  <option>2023</option>
                </select>

                <label>Mileage:</label>
                <select>
                  <option>All</option>
                  <option>0‚Äì50 000 km</option>
                  <option>50 000‚Äì100 000 km</option>
                  <option>100 000‚Äì150 000 km</option>
                  <option>150 000‚Äì200 000 km</option>
                  <option>200 000‚Äì300 000 km</option>
                  <option>300 000‚Äì500 000 km</option>
                </select>
              </div>

              <div class="filters-row car-filters">
                <label>Body Type:</label>
                <select>
                  <option>All</option>
                  <option>Hatchback</option>
                  <option>Sedan</option>
                  <option>SUV</option>
                  <option>Bakkie</option>
                  <option>Coupe</option>
                  <option>Van</option>
                </select>

                <label>Transmission:</label>
                <select>
                  <option>All</option>
                  <option>Manual</option>
                  <option>Automatic</option>
                </select>

                <label>Fuel Type:</label>
                <select>
                  <option>All</option>
                  <option>Petrol</option>
                  <option>Diesel</option>
                  <option>Hybrid</option>
                  <option>Electric</option>
                </select>

                <label>Condition:</label>
                <select>
                  <option>All</option>
                  <option>Brand New</option>
                  <option>Used ‚Äì Good</option>
                  <option>Used ‚Äì Fair</option>
                  <option>Salvage / Needs Work</option>
                </select>
              </div>

              <div class="filters-row car-filters">
                <label>Vehicle History:</label>
                <select>
                  <option>All</option>
                  <option>Full Service History (FSH)</option>
                  <option>Partial Service History</option>
                  <option>No Service History</option>
                  <option>Accident-Free</option>
                  <option>Rebuilt / Code 2</option>
                  <option>Code 3</option>
                  <option>One Owner</option>
                </select>

                <label>Seller Type:</label>
                <select>
                  <option>All</option>
                  <option>Private Seller</option>
                  <option>Dealer</option>
                  <option>Certified Dealer</option>
                </select>
              </div>
            </template>

            <!-- PHONES -->
            <template id="phoneFilters">
              <div class="filters-row phone-filters">
                <label>Brand:</label>
                <select>
                  <option>All</option>
                  <option>Samsung</option>
                  <option>Apple</option>
                  <option>Huawei</option>
                  <option>Xiaomi</option>
                  <option>Oppo</option>
                  <option>Vivo</option>
                  <!-- add more brands -->
                </select>

                <label>Model:</label>
                <select>
                  <option>All</option>
                  <option>iPhone 13</option>
                  <option>Samsung A54</option>
                  <!-- add more models -->
                </select>

                <label>Condition:</label>
                <select>
                  <option>All</option>
                  <option>New</option>
                  <option>Excellent</option>
                  <option>Good</option>
                  <option>Fair</option>
                  <option>Used</option>
                </select>
              </div>

              <div class="filters-row phone-filters">
                <label>Storage:</label>
                <select>
                  <option>All</option>
                  <option>16GB</option>
                  <option>32GB</option>
                  <option>64GB</option>
                  <option>128GB</option>
                  <option>256GB</option>
                  <option>512GB</option>
                  <option>1TB</option>
                </select>

                <label>RAM:</label>
                <select>
                  <option>All</option>
                  <option>2GB</option>
                  <option>3GB</option>
                  <option>4GB</option>
                  <option>6GB</option>
                  <option>8GB</option>
                  <option>12GB</option>
                  <option>16GB</option>
                </select>

                <label>Trade Options:</label>
                <select>
                  <option>All</option>
                  <option>Swap / Trade Accepted</option>
                  <option>Cash Only</option>
                  <option>Delivery Available</option>
                </select>
              </div>

              <div class="filters-row phone-filters">
                <label>Seller Type:</label>
                <select>
                  <option>All</option>
                  <option>Private Seller</option>
                  <option>Shop / Dealer</option>
                </select>
              </div>
            </template>

            <!-- PROPERTY -->
            <template id="propertyFilters">
              <div class="filters-row property-filters">
                <label>Property Type:</label>
                <select>
                  <option>All</option>
                  <option>House</option>
                  <option>Apartment / Flat</option>
                  <option>Townhouse</option>
                  <option>Duplex</option>
                  <option>Vacant Land</option>
                  <option>Farm</option>
                  <option>Commercial Property</option>
                  <option>Industrial Property</option>
                  <option>Office Space</option>
                  <option>Student Accommodation</option>
                </select>

                <label>Purpose:</label>
                <select>
                  <option>All</option>
                  <option>For Sale</option>
                  <option>Auction</option>
                  <option>To Rent</option>
                  <option>Rent-to-Own</option>
                </select>
              </div>

              <div class="filters-row property-filters">
                <label>Bedrooms:</label>
                <select>
                  <option>All</option>
                  <option>1+</option>
                  <option>2+</option>
                  <option>3+</option>
                  <option>4+</option>
                  <option>5+</option>
                </select>

                <label>Bathrooms:</label>
                <select>
                  <option>All</option>
                  <option>1+</option>
                  <option>2+</option>
                  <option>3+</option>
                  <option>4+</option>
                </select>
              </div>

              <div class="filters-row property-filters">
                <label>House Size (m¬≤):</label>
                <input type="number" placeholder="Min m¬≤">
                <input type="number" placeholder="Max m¬≤">

                <label>Land Size (m¬≤):</label>
                <input type="number" placeholder="Min m¬≤">
                <input type="number" placeholder="Max m¬≤">
              </div>

              <div class="filters-row property-filters">
                <label>Seller Type:</label>
                <select>
                  <option>All</option>
                  <option>Private Seller</option>
                  <option>Agent</option>
                  <option>Bank Sale</option>
                  <option>Auctioneer</option>
                 </select>
              </div>
            </template>

            <!-- Electronics -->
            <template id="ElectronicsFilters">
              <div class="filters-row Electronics-filters">

    <label>Product Type:</label>
    <select>
      <option>All</option>
      <option>TVs</option>
      <option>Laptops</option>
      <option>Desktops</option>
      <option>Tablets</option>
      <option>Cameras</option>
      <option>Gaming Consoles</option>
      <option>Audio Systems</option>
      <option>Speakers</option>
      <option>Headphones</option>
      <option>Smartwatches</option>
      <option>Smart Home Devices</option>
      <option>Printers & Scanners</option>
      <option>Routers / WiFi Equipment</option>
      <option>Home Theatre Systems</option>
      <option>Projectors</option>
      <option>Monitors</option>
      <option>Accessories</option>
    </select>

    <label>Brand:</label>
    <select>
      <option>All</option>
      <option>Samsung</option>
      <option>LG</option>
      <option>Sony</option>
      <option>Hisense</option>
      <option>Toshiba</option>
      <option>Apple</option>
      <option>Huawei</option>
      <option>Lenovo</option>
      <option>HP</option>
      <option>Dell</option>
      <option>Acer</option>
      <option>Canon</option>
      <option>Nikon</option>
      <option>JBL</option>
      <option>Bose</option>
      <option>PlayStation</option>
      <option>Xbox</option>
    </select>

    <label>Condition:</label>
    <select>
      <option>All</option>
      <option>New</option>
      <option>Used</option>
      <option>Refurbished</option>
      <option>Open-box</option>
    </select>
  </div>
</template>
            
            <!-- Fashion & Beauty -->
            <template id="Fashion & Beauty">
  <div class="filters-row Fashion-&-Beauty-filters">

    <label>Product Type:</label>
    <select>
      <option>All</option>
      <option>Skincare</option>
      <option>Haircare</option>
      <option>Makeup</option>
      <option>Fragrances</option>
      <option>Nail Care</option>
      <option>Bath & Body</option>
      <option>Beauty Tools & Devices</option>
      <option>Men's Grooming</option>
      <option>Beauty Services</option>
    </select>

    <label>Brand:</label>
    <select>
      <option>All</option>
      <option>Nivea</option>
      <option>Dove</option>
      <option>L'Or√©al</option>
      <option>Revlon</option>
      <option>Maybelline</option>
      <option>Yardley</option>
      <option>Sorbet</option>
      <option>Johnson's</option>
      <option>Garnier</option>
      <option>MAC</option>
      <option>Clinique</option>
      <option>Chanel</option>
      <option>Dior</option>
    </select>

    <label>Skin Type:</label>
    <select>
      <option>All</option>
      <option>Normal</option>
      <option>Dry</option>
      <option>Oily</option>
      <option>Combination</option>
      <option>Sensitive</option>
    </select>

    <label>Gender:</label>
    <select>
      <option>All</option>
      <option>Women</option>
      <option>Men</option>
      <option>Unisex</option>
    </select>

    <label>Condition:</label>
    <select>
      <option>All</option>
      <option>New</option>
      <option>Used</option>
      <option>Unboxed / Opened</option>
      <option>Bulk / Wholesale</option>
    </select>

  </div>
</template>

            <!-- CLOTHING -->
            <template id="clothingFilters">
              <div class="filters-row clothing-filters">
                <label>Brand:</label>
                <select>
                  <option>All</option>
                  <option>Nike</option>
                  <option>Adidas</option>
                  <option>Puma</option>
                  <!-- add more brands -->
                </select>

                <label>Category:</label>
                <select>
                  <option>All</option>
                  <option>Men</option>
                  <option>Women</option>
                  <option>Kids</option>
                  <option>Unisex</option>
                </select>
              </div>

              <div class="filters-row clothing-filters">
                <label>Clothing Type:</label>
                <select>
                  <option>All</option>
                  <option>T-Shirts</option>
                  <option>Shirts</option>
                  <option>Jeans</option>
                  <option>Trousers</option>
                  <option>Dresses</option>
                  <option>Hoodies</option>
                  <option>Jackets</option>
                  <option>Shorts</option>
                  <option>Activewear</option>
                  <option>Underwear</option>
                  <option>Sleepwear</option>
                  <option>Swimwear</option>
                  <option>School Uniforms</option>
                </select>

                <label>Condition:</label>
                <select>
                  <option>All</option>
                  <option>New</option>
                  <option>Like New</option>
                  <option>Good</option>
                  <option>Fair</option>
                  <option>Vintage</option>
                  <option>Damaged / For Upcycling</option>
                </select>
              </div>

              <div class="filters-row clothing-filters">
                <label>Seller Type:</label>
                <select>
                  <option>All</option>
                  <option>Private Seller</option>
                  <option>Boutique Store</option>
                  <option>Thrift Seller</option>
                </select>
              </div>
            </template>
            
             <!-- JOBS -->
           <template id="jobsFilters">
  <div class="filters-row jobs-filters">

    <label>Job Type:</label>
    <select>
      <option>All</option>
      <option>Full-time</option>
      <option>Part-time</option>
      <option>Contract</option>
      <option>Temporary</option>
      <option>Internship</option>
      <option>Freelance</option>
    </select>

    <label>Salary Range:</label>
    <select>
      <option>All</option>
      <option>R0‚ÄìR4,999</option>
      <option>R5,000‚ÄìR9,999</option>
      <option>R10,000‚ÄìR19,999</option>
      <option>R20,000‚ÄìR40,000</option>
      <option>Above R40,000</option>
    </select>

    <label>Experience Level:</label>
    <select>
      <option>All</option>
      <option>No experience</option>
      <option>1‚Äì2 years</option>
      <option>3‚Äì5 years</option>
      <option>5+ years</option>
    </select>

    <label>Education Level:</label>
    <select>
      <option>All</option>
      <option>Grade 12</option>
      <option>Certificate</option>
      <option>Diploma</option>
      <option>Degree</option>
      <option>Trade Test</option>
    </select>
        </div>
        </template>
            <template id="greenEnergyFilters">
              <div class="filters-row Green-Energy-filters">

                <label>Product Type:</label>
    <select>
      <option>All</option>
      <option>Solar Panels</option>
      <option>Inverters</option>
      <option>Batteries</option>
      <option>Charge Controllers</option>
      <option>Solar Kits (Complete Systems)</option>
      <option>Solar Geysers</option>
      <option>Wind Turbines</option>
      <option>Eco / Hybrid Generators</option>
      <option>UPS Systems</option>
      <option>Cables & Accessories</option>
      <option>Installation Services</option>
    </select>

    <label>Battery Type:</label>
    <select>
      <option>All</option>
      <option>Lithium (LiFePO4)</option>
      <option>AGM Deep Cycle</option>
      <option>Gel</option>
      <option>Lead-Acid</option>
      <option>Sodium-ion</option>
    </select>
                  <label>Battery Capacity:</label>
    <select>
      <option>All</option>
      <option>12V 50Ah</option>
      <option>12V 100Ah</option>
      <option>24V 100Ah</option>
      <option>48V 100Ah</option>
      <option>5 kWh</option>
      <option>10 kWh</option>
      <option>15 kWh+</option>
    </select>

    <label>Inverter Type:</label>
    <select>
      <option>All</option>
      <option>Pure Sine Wave</option>
      <option>Modified Sine Wave</option>
      <option>Hybrid Inverter</option>
      <option>Off-grid Inverter</option>
      <option>Grid-tied Inverter</option>
    </select>

    <label>Condition:</label>
    <select>
      <option>All</option>
      <option>New</option>
      <option>Used</option>
      <option>Refurbished</option>
    </select>

              </div>
            </template>

            <!-- JOBS -->
            <template id="OtherFilters">
              <div class="filters-row Other-filters">

    <label>Item Type:</label>
    <select>
      <option>All</option>
      <option>Antiques</option>
      <option>Collectibles</option>
      <option>Handcrafted Items</option>
      <option>Toys & Games</option>
      <option>Musical Instruments</option>
      <option>Sports & Outdoors</option>
      <option>Pet Supplies</option>
      <option>Office Supplies</option>
      <option>Tools</option>
      <option>Garden & Outdoor</option>
      <option>Craft & Hobby Items</option>
      <option>Event & Party Items</option>
      <option>Industrial & Commercial</option>
      <option>Lost & Found</option>
      <option>General</option>
    </select>

    <label>Condition:</label>
    <select>
      <option>All</option>
      <option>New</option>
      <option>Used</option>
      <option>Refurbished</option>
      <option>Open-box</option>
    </select>

  </div>
</template>
        </div>

        <section class="ads-grid" id="adsGrid"></section>
        <footer>
            <div style="max-width:1100px; margin:0 auto; text-align:left; display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:20px; padding:20px 10px;">
                <div>
                    <h4 style="font-size:0.9rem; font-weight:700; margin-bottom:6px;">Account</h4>
                    <p><a href="my-account.html">My Account</a></p>
                    <p><a href="track-order.html">Track Order</a></p>
                    <p><a href="returns.html">Returns</a></p>
                    <p><a href="personal-details.html">Personal Details</a></p>
                    <p><a href="invoices.html">Invoices</a></p>
                </div>
                <div>
                    <h4 style="font-size:0.9rem; font-weight:700; margin-bottom:6px;">Help</h4>
                    <p><a href="help-centre.html">Help Centre</a></p>
                    <p><a href="contact-us.html">Contact Us</a></p>
                    <p><a href="shipping-delivery.html">Shipping & Delivery</a></p>
                    <p><a href="returns.html">Returns</a></p>
                </div>
                <div>
                    <h4 style="font-size:0.9rem; font-weight:700; margin-bottom:6px;">Company</h4>
                    <p><a href="about-us.html">About Us</a></p>
                </div>
                <div>
                    <h4 style="font-size:0.9rem; font-weight:700; margin-bottom:6px;">HoneySweetpot Policy</h4>
                    <p><a href="returns-policy.html">Returns Policy</a></p>
                    <p><a href="terms-conditions.html">Terms & Conditions</a></p>
                    <p><a href="privacy-policy.html">Privacy Policy</a></p>
                </div>
            </div>
            <div style="text-align:center; margin-top:20px; font-size:0.8rem; color:#fff;">&copy; HoneySweetpot South Africa (Pty) Ltd.</div>
        </footer>
    </main>

    <!-- Login modal -->
    <div class="auth-backdrop" id="loginBackdrop">
        <div class="auth-modal">
            <div class="auth-header">
                <h2>Login</h2>
                <button class="auth-close" id="loginClose">&times;</button>
            </div>
            <div class="auth-body">
                <label for="loginEmail">Email or Phone</label>
                <input id="loginEmail" type="text" placeholder="you@example.com" />
                <label for="loginPassword">Password</label>
                <div class="password-wrapper"><input id="loginPassword" type="password" placeholder="Enter your password" /><button type="button" class="toggle-password" aria-label="Toggle password visibility">üëÅÔ∏è</button></div>
                <button class="auth-submit" id="loginSubmit">Login</button>
                <div class="auth-actions">
                    <span id="forgotPassword" class="auth-link" style="font-size:0.8rem;">Forgot Password?</span>
                    <span>New here? <span id="goToSignup" class="auth-link">Create an account</span></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Sign up modal -->
    <div class="auth-backdrop" id="signupBackdrop">
        <div class="auth-modal">
            <div class="auth-header">
                <h2>Create Free Account</h2>
                <button class="auth-close" id="signupClose">&times;</button>
            </div>
            <div class="auth-body">
                <label for="signupName">Name</label>
                <input id="signupName" type="text" placeholder="First Name" />
                <label for="signupSurname">Surname</label>
                <input id="signupSurname" type="text" placeholder="Last Name" />
                <label for="signupAddress">Address</label>
                <input id="signupAddress" type="text" placeholder="Your Address" />
                <label for="signupPhone">Phone Number</label>
                <input id="signupPhone" type="tel" placeholder="072 123 4567" />
                <label for="signupEmail">Email</label>
                <input id="signupEmail" type="email" placeholder="you@example.com" />
                
                <label>I am a:</label>
                <select id="signupRole">
                    <option value="buyer">Buyer</option>
                    <option value="seller">Seller</option>
                </select>

                <div id="bankDetailsSection" class="hidden">
                    <label for="signupBank">Bank Account Details</label>
                    <textarea id="signupBank" placeholder="Bank Name, Account Number, Branch Code" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; margin-bottom:10px;"></textarea>
                </div>

                <div class="field-group">
                    <label for="signupPassword">Password</label>
                    <div class="password-wrapper"><input id="signupPassword" type="password" placeholder="Create a password" /><button type="button" class="toggle-password" aria-label="Toggle password visibility">üëÅÔ∏è</button></div>
                </div>
                <div class="field-group">
                    <label for="signupPasswordConfirm">Confirm Password</label>
                    <div class="password-wrapper"><input id="signupPasswordConfirm" type="password" placeholder="Re-enter password" /><button type="button" class="toggle-password" aria-label="Toggle password visibility">üëÅÔ∏è</button></div>
                </div>

                <button class="auth-submit" id="signupSubmit">Create account</button>
                <div class="auth-actions">
                    <span>Already have an account? <span id="goToLogin" class="auth-link">Login</span></span>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { supabaseClient, signIn, signUp, resetPassword } from './app.js';

        // --- Ads Logic ---
        let ads = [];
        const adsGrid = document.getElementById("adsGrid");
        const filterCategory = document.getElementById("filterCategory");
        const filterSort = document.getElementById("filterSort");
        const filterCondition = document.getElementById("filterCondition");
        const filterVerified = document.getElementById("filterVerified");
        const priceMin = document.getElementById("priceMin");
        const priceMax = document.getElementById("priceMax");
        const searchText = document.getElementById("searchText");
        const searchLocation = document.getElementById("searchLocation");
        const provinceSelect = document.getElementById("provinceSelect");
        const moreFiltersBtn = document.getElementById("moreFiltersBtn");
        const dynamicFiltersContainer = document.getElementById("dynamicFiltersContainer");
        const dynamicCategoryFilters = document.getElementById("dynamicCategoryFilters");

        // Show/hide Additional Filters, but the contents themselves depend on category
        if (moreFiltersBtn && dynamicFiltersContainer) {
            moreFiltersBtn.addEventListener("click", (e) => {
                e.preventDefault();
                if (dynamicFiltersContainer.style.display === "none" || dynamicFiltersContainer.style.display === "") {
                    dynamicFiltersContainer.style.display = "block";
                    moreFiltersBtn.textContent = "Less Filters";
                } else {
                    dynamicFiltersContainer.style.display = "none";
                    moreFiltersBtn.textContent = "More Filters";
                }
            });
        }

        // Update which extra filters show based on category
        function updateCategoryFilters() {
            if (!dynamicCategoryFilters) return;
            dynamicCategoryFilters.innerHTML = "";

            const cat = filterCategory.value;
            let templateId = null;

            if (cat === "Cars") {
                templateId = "carFilters";
            } else if (cat === "Phones") {
                templateId = "phoneFilters";
            } else if (cat === "Property") {
                templateId = "propertyFilters";
            } else if (cat === "Electronics") {
                templateId = "ElectronicsFilters";
            } else if (cat === "Fashion & Beauty") {
                templateId = "Fashion & Beauty";
            } else if (cat === "Clothing") {
                templateId = "clothingFilters";
            } else if (cat === "Jobs") {
                templateId = "jobsFilters";
            } else if (cat === "Green Energy") {
                templateId = "greenEnergyFilters";
            } else if (cat === "Other") {
                templateId = "OtherFilters";
            }

            if (templateId) {
                const tpl = document.getElementById(templateId);
                if (tpl) {
                    const clone = tpl.content.cloneNode(true);
                    dynamicCategoryFilters.appendChild(clone);
                }
            }
        }

        // Province Data
        const provinceAreas = {
            "Gauteng": ["Johannesburg","Soweto","Pretoria","Centurion","Sandton","Midrand","Randburg","Roodepoort","Krugersdorp","Alberton","Benoni","Boksburg","Brakpan","Springs","Germiston","Kempton Park","Tembisa","Katlehong","Vosloorus","Mamelodi","Soshanguve","Ga-Rankuwa","Vanderbijlpark","Vereeniging","Heidelberg","Nigel","Cullinan","Bronkhorstspruit","Carletonville","Westonaria","Randfontein","Lenasia","Diepsloot","Tsakane","Daveyton","Edenvale","Bedfordview"],
            "Western Cape": ["Cape Town","Bellville","Brackenfell","Durbanville","Goodwood","Parow","Kraaifontein","Kuils River","Mitchells Plain","Khayelitsha","Fish Hoek","Muizenberg","Somerset West","Strand","Gordons Bay","Stellenbosch","Paarl","Wellington","Franschhoek","Worcester","Ceres","Robertson","George","Mossel Bay","Oudtshoorn","Knysna","Plettenberg Bay","Beaufort West","Vredenburg","Saldanha","Malmesbury","Langebaan"],
            "KwaZulu-Natal": ["Durban","Umlazi","Chatsworth","Phoenix","Pinetown","Westville","Hillcrest","Kloof","Queensburgh","Umbilo","Isipingo","Umkomaas","Amanzimtoti","Umhlanga","Ballito","Stanger","Richards Bay","Empangeni","Eshowe","Mtunzini","Port Shepstone","Margate","Ramsgate","Harding","Pietermaritzburg","Howick","Mooi River","Greytown","Newcastle","Ladysmith","Estcourt","Vryheid","Dundee","Bergville"],
            "Eastern Cape": ["Gqeberha","Uitenhage","Despatch","East London","Mdantsane","King William's Town","Qonce","Bhisho","Butterworth","Mthatha","Queenstown","Aliwal North","Makhanda","Graaff-Reinet","Cradock","Port Alfred","Jeffreys Bay","Humansdorp","Kirkwood","Fort Beaufort","Alice","Stutterheim","Mount Frere","Matatiele","Lusikisiki","Port St Johns"],
            "Free State": ["Bloemfontein","Botshabelo","Thaba Nchu","Welkom","Virginia","Hennenman","Odendaalsrus","Kroonstad","Sasolburg","Parys","Vredefort","Phuthaditjhaba","Bethlehem","Reitz","Harrismith","Clocolan","Ladybrand","Ficksburg","Fouriesburg","Warden","Heilbron","Viljoenskroon","Frankfort","Deneysville"],
            "North West": ["Mahikeng","Mmabatho","Rustenburg","Klerksdorp","Jouberton","Orkney","Stilfontein","Potchefstroom","Ikageng","Vryburg","Lichtenburg","Zeerust","Schweizer-Reneke","Bloemhof","Christiana","Brits","Hartebeespoort","Mogwase","Sun City","Ventersdorp","Coligny","Swartruggens"],
            "Limpopo": ["Polokwane","Seshego","Lebowakgomo","Mankweng","Thohoyandou","Sibasa","Louis Trichardt","Makhado","Musina","Tzaneen","Letsitele","Phalaborwa","Giyani","Malamulele","Burgersfort","Mokopane","Mahwelereng","Modimolle","Bela-Bela","Lephalale","Thabazimbi","Dendron","Botlokwa"],
            "Mpumalanga": ["Mbombela","Nelspruit","White River","Hazyview","Sabie","Graskop","Lydenburg","Mashishing","Barberton","Malelane","Komatipoort","Ermelo","Secunda","Trichardt","Bethal","Standerton","Middelburg","eMalahleni","Witbank","Ogies","Delmas","Volksrust","Carolina","Mkhondo","Piet Retief"],
            "Northern Cape": ["Kimberley","Barkly West","Warrenton","Jan Kempdorp","Hartswater","Upington","Keimoes","Kakamas","Groblershoop","Prieska","De Aar","Britstown","Victoria West","Strydenburg","Colesberg","Springbok","Okiep","Concordia","Pofadder","Port Nolloth","Alexander Bay","Kuruman","Kathu","Postmasburg","Danielskuil"]
        };

        function populateTownsForProvince(province) {
            searchLocation.innerHTML = "";
            const defaultOption = document.createElement("option");
            defaultOption.value = "";
            defaultOption.textContent = "Select Town / City";
            searchLocation.appendChild(defaultOption);
            if (province === "All provinces") return;
            const towns = provinceAreas[province] || [];
            towns.forEach(town => {
                const option = document.createElement("option");
                option.value = town;
                option.textContent = town;
                searchLocation.appendChild(option);
            });
        }

        provinceSelect.addEventListener("change", () => {
            populateTownsForProvince(provinceSelect.value);
            applyFilters();
        });

        const PLACEHOLDER_IMG = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23cccccc'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='24' fill='%23666666'%3ENo Image%3C/text%3E%3C/svg%3E";

        function renderAds(list) {
            adsGrid.innerHTML = "";
            if (!list.length) {
                adsGrid.innerHTML = "<p>No ads found. Try changing your filters.</p>";
                return;
            }
            list.forEach(ad => {
                const card = document.createElement("article");
                card.className = "ad-card";
                card.dataset.id = ad.id;
                
                const imgDiv = document.createElement("div");
                imgDiv.className = "ad-image";
                const img = document.createElement("img");
                img.src = ad.img || PLACEHOLDER_IMG;
                img.loading = "lazy";
                imgDiv.appendChild(img);

                const body = document.createElement("div");
                body.className = "ad-body";
                const price = document.createElement("div");
                price.className = "ad-price";
                price.textContent = ad.price > 0 ? "R " + Number(ad.price).toLocaleString() : "Price on request";
                const title = document.createElement("div");
                title.className = "ad-title";
                title.textContent = ad.title;
                const location = document.createElement("div");
                location.className = "ad-location";
                location.textContent = ad.location + " ‚Ä¢ " + ad.category;
                const meta = document.createElement("div");
                meta.className = "ad-meta";
                meta.textContent = "Posted: " + ad.postedAt;
                body.appendChild(price);
                body.appendChild(title);
                body.appendChild(location);
                body.appendChild(meta);
                card.appendChild(imgDiv);
                card.appendChild(body);
                
                card.addEventListener("click", () => {
                    window.location.href = `ad-details.html?id=${ad.id}`;
                });
                
                adsGrid.appendChild(card);
            });
        }

        async function fetchAdsFromSupabase() {
            const { data, error } = await supabaseClient
                .from("ads")
                .select("*")
                .order("created_at", { ascending: false });
            if (error) {
                console.error("Error fetching ads from Supabase:", error);
                return;
            }
            ads = (data || []).map(row => {
                let primaryImg = "";
                if (row.images && Array.isArray(row.images) && row.images.length > 0) {
                    const validImg = row.images.find(url => url && (url.match(/^https?:\/\//i) || url.match(/^data:image\//i) || url.startsWith('/')));
                    primaryImg = validImg || row.images[0];
                } else {
                    primaryImg = row.image_url || "";
                }

                if (primaryImg && !primaryImg.match(/^https?:\/\//i) && !primaryImg.match(/^data:image\//i) && !primaryImg.startsWith('/')) {
                    primaryImg = "";
                }

                return {
                    id: row.id,
                    title: row.title,
                    price: row.price || 0,
                    category: row.category,
                    condition: row.condition || "Used",
                    verified: row.verified || false,
                    location: row.location,
                    img: primaryImg,
                    description: row.description,
                    seller: row.seller_name || (row.contact ? row.contact : "Private seller"),
                    postedAt: row.created_at ? row.created_at.slice(0, 10) : ""
                };
            });
            applyFilters();
        }

        function applyFilters() {
            let list = [...ads];
            
            const text = searchText.value.trim().toLowerCase();
            if (text) {
                list = list.filter(ad =>
                    ad.title.toLowerCase().includes(text) ||
                    ad.description.toLowerCase().includes(text)
                );
            }

            const province = provinceSelect.value;
            const loc = searchLocation.value.toLowerCase();
            
            if (province && province !== "All provinces") {
                list = list.filter(ad => {
                    const adLoc = ad.location.toLowerCase();
                    const towns = (provinceAreas[province] || []).map(t => t.toLowerCase());
                    return towns.includes(adLoc) || adLoc.includes(province.toLowerCase());
                });
            }
            
            if (loc) {
                list = list.filter(ad => ad.location.toLowerCase() === loc);
            }

            const cat = filterCategory.value;
            if (cat) {
                list = list.filter(ad => ad.category === cat);
            }

            const cond = filterCondition.value;
            if (cond) {
                list = list.filter(ad => ad.condition === cond);
            }

            if (filterVerified.checked) {
                list = list.filter(ad => ad.verified === true);
            }

            const min = priceMin.value ? Number(priceMin.value) : 0;
            const max = priceMax.value ? Number(priceMax.value) : Infinity;
            
            list = list.filter(ad => {
                const p = ad.price || 0;
                return p >= min && p <= max;
            });

            const sort = filterSort.value;
            if (sort === "priceLow") {
                list.sort((a, b) => (a.price || 0) - (b.price || 0));
            } else if (sort === "priceHigh") {
                list.sort((a, b) => (b.price || 0) - (a.price || 0));
            } else if (sort === "newest") {
                list.sort((a, b) => new Date(b.postedAt) - new Date(a.postedAt));
            }
            renderAds(list);
        }

        document.getElementById("searchBtn").addEventListener("click", applyFilters);
        filterCategory.addEventListener("change", () => {
            updateCategoryFilters();
            applyFilters();
        });
        filterSort.addEventListener("change", applyFilters);
        filterCondition.addEventListener("change", applyFilters);
        filterVerified.addEventListener("change", applyFilters);
        priceMin.addEventListener("input", applyFilters);
        priceMax.addEventListener("input", applyFilters);
        searchLocation.addEventListener("change", applyFilters);
        searchText.addEventListener("keyup", (e) => {
            if (e.key === "Enter") applyFilters();
        });

        document.getElementById("categoryList").addEventListener("click", (e) => {
            const card = e.target.closest(".category-card");
            if (!card) return;
            const cat = card.dataset.category;
            filterCategory.value = cat;
            updateCategoryFilters();
            applyFilters();
            const filtersEl = document.querySelector(".filters-container");
            if (filtersEl) {
                window.scrollTo({ top: filtersEl.offsetTop - 60, behavior: "smooth" });
            }
        });

        // --- Auth Modals Logic ---
        const loginBtn = document.getElementById("loginBtn");
        const signupBtn = document.getElementById("signupBtn");
        const loginBackdrop = document.getElementById("loginBackdrop");
        const signupBackdrop = document.getElementById("signupBackdrop");
        const loginClose = document.getElementById("loginClose");
        const signupClose = document.getElementById("signupClose");
        const goToSignup = document.getElementById("goToSignup");
        const goToLogin = document.getElementById("goToLogin");
        const forgotPassword = document.getElementById("forgotPassword");
        const signupRole = document.getElementById("signupRole");
        const bankDetailsSection = document.getElementById("bankDetailsSection");

        if(loginBtn) loginBtn.addEventListener("click", () => loginBackdrop.style.display = "flex");
        if(signupBtn) signupBtn.addEventListener("click", () => {
            signupBackdrop.classList.add("active");
            if(signupRole) signupRole.value = "buyer";
            if(bankDetailsSection) bankDetailsSection.classList.add("hidden");
        });
        if(loginClose) loginClose.addEventListener("click", () => loginBackdrop.style.display = "none");
        if(signupClose) signupClose.addEventListener("click", () => signupBackdrop.classList.remove("active"));
        
        if(goToSignup) goToSignup.addEventListener("click", () => {
            loginBackdrop.style.display = "none";
            signupBackdrop.classList.add("active");
            if(signupRole) signupRole.value = "buyer";
            if(bankDetailsSection) bankDetailsSection.classList.add("hidden");
        });
        if(goToLogin) goToLogin.addEventListener("click", () => {
            signupBackdrop.classList.remove("active");
            loginBackdrop.style.display = "flex";
        });

        if(signupRole) {
            signupRole.addEventListener("change", () => {
                if(signupRole.value === "seller") {
                    bankDetailsSection.classList.remove("hidden");
                } else {
                    bankDetailsSection.classList.add("hidden");
                }
            });
        }

        if(forgotPassword) {
            forgotPassword.addEventListener("click", async () => {
                const email = prompt("Please enter your email address to reset your password:");
                if(email) {
                    const { error } = await resetPassword(email);
                    if(error) alert("Error: " + error.message);
                    else alert("Password reset link sent to " + email);
                }
            });
        }

        document.getElementById("loginSubmit").addEventListener("click", async () => {
            const email = document.getElementById("loginEmail").value;
            const password = document.getElementById("loginPassword").value;
            const { error } = await signIn(email, password);
            if (error) alert("Login failed: " + error.message);
            else {
                loginBackdrop.style.display = "none";
            }
        });

        document.getElementById("signupSubmit").addEventListener("click", async () => {
            const email = document.getElementById("signupEmail").value;
            const password = document.getElementById("signupPassword").value;
            const confirm = document.getElementById("signupPasswordConfirm").value;
            
            if(password !== confirm) {
                alert("Passwords do not match!");
                return;
            }

            const metadata = {
                first_name: document.getElementById("signupName").value,
                last_name: document.getElementById("signupSurname").value,
                address: document.getElementById("signupAddress").value,
                phone: document.getElementById("signupPhone").value,
                role: document.getElementById("signupRole").value,
                bank_details: document.getElementById("signupBank").value
            };

            const { error } = await signUp(email, password, metadata);
            if (error) alert("Signup failed: " + error.message);
            else {
                alert("Account created! Please check your email to verify.");
                signupBackdrop.classList.remove("active");
            }
        });

        populateTownsForProvince("All provinces");
        fetchAdsFromSupabase();
        updateCategoryFilters(); // ensure correct extra filters on load
    </script>
    <!-- Choices.js CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />

<!-- Choices.js library -->
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

<!-- Your Choices init file -->
<script type="module" src="choices.js"></script>
<script src="choices.js"></script>
</body>
</html>
