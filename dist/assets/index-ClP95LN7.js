import{createClient as O}from"https://esm.sh/@supabase/supabase-js@2";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();const F="https://vmgpyjpbxfvnttnjbpsa.supabase.co",G="sb_publishable_eFTbKKlL1mileWxBduPXDQ_zZDUAtOW",m=O(F,G);window.supabaseClient=m;async function U(e,n,t){const{data:i,error:o}=await m.auth.signUp({email:e,password:n,options:{data:t}});return{data:i,error:o}}async function z(e,n){const{data:t,error:i}=await m.auth.signInWithPassword({email:e,password:n});return{data:t,error:i}}async function V(e){const{data:n,error:t}=await m.auth.resetPasswordForEmail(e,{redirectTo:"https://classifind.netlify.app"});return{data:n,error:t}}async function _(){const{error:e}=await m.auth.signOut();return{error:e}}async function j(){const{data:e}=await m.auth.getSession();return e.session}function x(e){const n=document.getElementById("loginBtn"),t=document.getElementById("signupBtn"),i=document.querySelector(".header-actions"),o=document.getElementById("userMenu");if(o&&o.remove(),e){n&&(n.style.display="none"),t&&(t.style.display="none");const a=document.createElement("div");a.id="userMenu",a.style.display="flex",a.style.alignItems="center",a.style.gap="10px";const r=document.createElement("span");r.textContent=e.user.email,r.style.fontSize="0.9rem",r.style.color="#fff";const u=document.createElement("button");u.className="btn",u.textContent="Logout",u.onclick=async()=>{await _(),window.location.reload()},a.appendChild(r),a.appendChild(u);const l=document.getElementById("postAdBtn");l&&l.parentNode?l.parentNode.insertBefore(a,l):i.appendChild(a)}else n&&(n.style.display="inline-block"),t&&(t.style.display="inline-block")}m.auth.onAuthStateChange((e,n)=>{x(n)});j().then(e=>{x(e)});let A=[];const E=document.getElementById("adsGrid"),w=document.getElementById("filterCategory"),N=document.getElementById("filterSort"),T=document.getElementById("filterCondition"),K=document.getElementById("filterVerified"),v=document.getElementById("priceMin"),B=document.getElementById("priceMax"),R=document.getElementById("searchText"),f=document.getElementById("searchLocation"),b=document.getElementById("provinceSelect"),D={Gauteng:["Johannesburg","Soweto","Pretoria","Centurion","Sandton","Midrand","Randburg","Roodepoort","Krugersdorp","Alberton","Benoni","Boksburg","Brakpan","Springs","Germiston","Kempton Park","Tembisa","Katlehong","Vosloorus","Mamelodi","Soshanguve","Ga-Rankuwa","Vanderbijlpark","Vereeniging","Heidelberg","Nigel","Cullinan","Bronkhorstspruit","Carletonville","Westonaria","Randfontein","Lenasia","Diepsloot","Tsakane","Daveyton","Edenvale","Bedfordview"],"Western Cape":["Cape Town","Bellville","Brackenfell","Durbanville","Goodwood","Parow","Kraaifontein","Kuils River","Mitchells Plain","Khayelitsha","Fish Hoek","Muizenberg","Somerset West","Strand","Gordons Bay","Stellenbosch","Paarl","Wellington","Franschhoek","Worcester","Ceres","Robertson","George","Mossel Bay","Oudtshoorn","Knysna","Plettenberg Bay","Beaufort West","Vredenburg","Saldanha","Malmesbury","Langebaan"],"KwaZulu-Natal":["Durban","Umlazi","Chatsworth","Phoenix","Pinetown","Westville","Hillcrest","Kloof","Queensburgh","Umbilo","Isipingo","Umkomaas","Amanzimtoti","Umhlanga","Ballito","Stanger","Richards Bay","Empangeni","Eshowe","Mtunzini","Port Shepstone","Margate","Ramsgate","Harding","Pietermaritzburg","Howick","Mooi River","Greytown","Newcastle","Ladysmith","Estcourt","Vryheid","Dundee","Bergville"],"Eastern Cape":["Gqeberha","Uitenhage","Despatch","East London","Mdantsane","King William's Town","Qonce","Bhisho","Butterworth","Mthatha","Queenstown","Aliwal North","Makhanda","Graaff-Reinet","Cradock","Port Alfred","Jeffreys Bay","Humansdorp","Kirkwood","Fort Beaufort","Alice","Stutterheim","Mount Frere","Matatiele","Lusikisiki","Port St Johns"],"Free State":["Bloemfontein","Botshabelo","Thaba Nchu","Welkom","Virginia","Hennenman","Odendaalsrus","Kroonstad","Sasolburg","Parys","Vredefort","Phuthaditjhaba","Bethlehem","Reitz","Harrismith","Clocolan","Ladybrand","Ficksburg","Fouriesburg","Warden","Heilbron","Viljoenskroon","Frankfort","Deneysville"],"North West":["Mahikeng","Mmabatho","Rustenburg","Klerksdorp","Jouberton","Orkney","Stilfontein","Potchefstroom","Ikageng","Vryburg","Lichtenburg","Zeerust","Schweizer-Reneke","Bloemhof","Christiana","Brits","Hartebeespoort","Mogwase","Sun City","Ventersdorp","Coligny","Swartruggens"],Limpopo:["Polokwane","Seshego","Lebowakgomo","Mankweng","Thohoyandou","Sibasa","Louis Trichardt","Makhado","Musina","Tzaneen","Letsitele","Phalaborwa","Giyani","Malamulele","Burgersfort","Mokopane","Mahwelereng","Modimolle","Bela-Bela","Lephalale","Thabazimbi","Dendron","Botlokwa"],Mpumalanga:["Mbombela","Nelspruit","White River","Hazyview","Sabie","Graskop","Lydenburg","Mashishing","Barberton","Malelane","Komatipoort","Ermelo","Secunda","Trichardt","Bethal","Standerton","Middelburg","eMalahleni","Witbank","Ogies","Delmas","Volksrust","Carolina","Mkhondo","Piet Retief"],"Northern Cape":["Kimberley","Barkly West","Warrenton","Jan Kempdorp","Hartswater","Upington","Keimoes","Kakamas","Groblershoop","Prieska","De Aar","Britstown","Victoria West","Strydenburg","Colesberg","Springbok","Okiep","Concordia","Pofadder","Port Nolloth","Alexander Bay","Kuruman","Kathu","Postmasburg","Danielskuil"]};function W(e){f.innerHTML="";const n=document.createElement("option");if(n.value="",n.textContent="Select Town / City",f.appendChild(n),e==="All provinces")return;(D[e]||[]).forEach(i=>{const o=document.createElement("option");o.value=i,o.textContent=i,f.appendChild(o)})}b.addEventListener("change",()=>{W(b.value),d()});const q="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23cccccc'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='24' fill='%23666666'%3ENo Image%3C/text%3E%3C/svg%3E";function J(e){if(E.innerHTML="",!e.length){E.innerHTML="<p>No ads found. Try changing your filters.</p>";return}e.forEach(n=>{const t=document.createElement("article");t.className="ad-card",t.dataset.id=n.id;const i=document.createElement("div");i.className="ad-image";const o=document.createElement("img");o.src=n.img||q,o.loading="lazy",i.appendChild(o);const a=document.createElement("div");a.className="ad-body";const r=document.createElement("div");r.className="ad-price",r.textContent=n.price>0?"R "+Number(n.price).toLocaleString():"Price on request";const u=document.createElement("div");u.className="ad-title",u.textContent=n.title;const l=document.createElement("div");l.className="ad-location",l.textContent=n.location+" â€¢ "+n.category;const s=document.createElement("div");s.className="ad-meta",s.textContent="Posted: "+n.postedAt,a.appendChild(r),a.appendChild(u),a.appendChild(l),a.appendChild(s),t.appendChild(i),t.appendChild(a),t.addEventListener("click",()=>{window.location.href=`ad-details.html?id=${n.id}`}),E.appendChild(t)})}async function Q(){const{data:e,error:n}=await m.from("ads").select("*").order("created_at",{ascending:!1});if(n){console.error("Error fetching ads from Supabase:",n);return}A=(e||[]).map(t=>{let i="";return t.images&&Array.isArray(t.images)&&t.images.length>0?i=t.images[0]:i=t.image_url||"",{id:t.id,title:t.title,price:t.price||0,category:t.category,condition:t.condition||"Used",verified:t.verified||!1,location:t.location,img:i,description:t.description,seller:t.seller_name||(t.contact?t.contact:"Private seller"),postedAt:t.created_at?t.created_at.slice(0,10):""}}),d()}function d(){let e=[...A];const n=R.value.trim().toLowerCase();n&&(e=e.filter(s=>s.title.toLowerCase().includes(n)||s.description.toLowerCase().includes(n)));const t=b.value,i=f.value.toLowerCase();t&&t!=="All provinces"&&(e=e.filter(s=>{const c=s.location.toLowerCase();return(D[t]||[]).map(H=>H.toLowerCase()).includes(c)||c.includes(t.toLowerCase())})),i&&(e=e.filter(s=>s.location.toLowerCase()===i));const o=w.value;o&&(e=e.filter(s=>s.category===o));const a=T.value;a&&(e=e.filter(s=>s.condition===a)),K.checked&&(e=e.filter(s=>s.verified===!0));const r=v.value?Number(v.value):0,u=B.value?Number(B.value):1/0;e=e.filter(s=>{const c=s.price||0;return c>=r&&c<=u});const l=N.value;l==="priceLow"?e.sort((s,c)=>(s.price||0)-(c.price||0)):l==="priceHigh"?e.sort((s,c)=>(c.price||0)-(s.price||0)):l==="newest"&&e.sort((s,c)=>new Date(c.postedAt)-new Date(s.postedAt)),J(e)}document.getElementById("searchBtn").addEventListener("click",d);w.addEventListener("change",d);N.addEventListener("change",d);T.addEventListener("change",d);K.addEventListener("change",d);v.addEventListener("input",d);B.addEventListener("input",d);f.addEventListener("change",d);R.addEventListener("keyup",e=>{e.key==="Enter"&&d()});document.getElementById("categoryList").addEventListener("click",e=>{const n=e.target.closest(".category-card");if(!n)return;const t=n.dataset.category;w.value=t,d();const i=document.querySelector(".filters");i&&window.scrollTo({top:i.offsetTop-60,behavior:"smooth"})});const L=document.getElementById("loginBtn"),C=document.getElementById("signupBtn"),y=document.getElementById("loginBackdrop"),h=document.getElementById("signupBackdrop"),k=document.getElementById("loginClose"),I=document.getElementById("signupClose"),S=document.getElementById("goToSignup"),P=document.getElementById("goToLogin"),M=document.getElementById("forgotPassword"),g=document.getElementById("signupRole"),p=document.getElementById("bankDetailsSection");L&&L.addEventListener("click",()=>y.style.display="flex");C&&C.addEventListener("click",()=>{h.style.display="flex",g&&(g.value="buyer"),p&&p.classList.add("hidden")});k&&k.addEventListener("click",()=>y.style.display="none");I&&I.addEventListener("click",()=>h.style.display="none");S&&S.addEventListener("click",()=>{y.style.display="none",h.style.display="flex",g&&(g.value="buyer"),p&&p.classList.add("hidden")});P&&P.addEventListener("click",()=>{h.style.display="none",y.style.display="flex"});g&&g.addEventListener("change",()=>{g.value==="seller"?p.classList.remove("hidden"):p.classList.add("hidden")});M&&M.addEventListener("click",async()=>{const e=prompt("Please enter your email address to reset your password:");if(e){const{error:n}=await V(e);alert(n?"Error: "+n.message:"Password reset link sent to "+e)}});document.getElementById("loginSubmit").addEventListener("click",async()=>{const e=document.getElementById("loginEmail").value,n=document.getElementById("loginPassword").value,{error:t}=await z(e,n);t?alert("Login failed: "+t.message):y.style.display="none"});document.getElementById("signupSubmit").addEventListener("click",async()=>{const e=document.getElementById("signupEmail").value,n=document.getElementById("signupPassword").value,t=document.getElementById("signupPasswordConfirm").value;if(n!==t){alert("Passwords do not match!");return}const i={first_name:document.getElementById("signupName").value,last_name:document.getElementById("signupSurname").value,address:document.getElementById("signupAddress").value,phone:document.getElementById("signupPhone").value,role:document.getElementById("signupRole").value,bank_details:document.getElementById("signupBank").value},{error:o}=await U(e,n,i);o?alert("Signup failed: "+o.message):(alert("Account created! Please check your email to verify."),h.style.display="none")});document.getElementById("year").textContent=new Date().getFullYear();W("All provinces");Q();
//# sourceMappingURL=index-ClP95LN7.js.map
